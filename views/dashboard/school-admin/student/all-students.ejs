<!doctype html>
<html class="no-js" lang="ar">

<%- include('../../../partials/head.ejs') %>

<body class="rtl">

<div class="bmd-layout-container bmd-drawer-f-l avam-container animated bmd-drawer-in">

  <%- include('../../../partials/header.ejs') %>

  <div id="dw-s1" class="bmd-layout-drawer bg-faded">
    <%- include('../../../partials/sidebar/index.ejs') %>
  </div>

  <main class="bmd-layout-content">
    <div class="container-fluid">

      <!-- breadcrumb -->
      <div class="row m-1 pb-4 mb-3">
        <div class="col-12 p-2">
          <div class="page-header breadcrumb-header">
            <div class="row align-items-end">
              <div class="col-lg-8">
                <div class="page-header-title text-left-rtl">
                  <div class="d-inline">
                    <h3 class="lite-text">ุฌููุน ุงูุทูุงุจ</h3>
                    <span class="lite-text text-gray">ุนุฑุถ ุฌููุน ุงูุทูุงุจ ูู ุงููุฏุฑุณุฉ</span>
                  </div>
                </div>
              </div>
              <div class="col-lg-4">
                <a href="/school-admin/students/create" class="btn btn-success float-left">
                  <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุทุงูุจ
                </a>
                <ol class="breadcrumb float-sm-right">
                  <li class="breadcrumb-item">
                    <a href="/dashboard"><i class="fas fa-home"></i></a>
                  </li>
                  <li class="breadcrumb-item active">ุงูุทูุงุจ</li>
                </ol>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Flash Messages -->
      <% if (locals.success && locals.success.length > 0) { %>
        <div class="alert alert-success"><%= locals.success %></div>
      <% } %>
      <% if (locals.error && locals.error.length > 0) { %>
        <div class="alert alert-danger"><%= locals.error %></div>
      <% } %>

      <!-- ุฌุฏูู ุนุฑุถ ุงูุทูุงุจ -->
      <div class="row m-1">
        <div class="col-12 p-2">
          <div class="card shade h-100">
            <div class="card-header">
              ูุงุฆูุฉ ุงูุทูุงุจ
            </div>

            <div class="card-body">

              <!-- ๐ ุจุญุซ ููุฑู -->
              <div class="row mb-3">
                <div class="col-md-4">
                  <input
                    type="text"
                    id="studentSearch"
                    class="form-control"
                    placeholder="ุงุจุญุซ ุจุงุณู ุงูุทุงูุจ ุฃู ุงููุตู ุฃู ุงูุดุนุจุฉ..."
                  >
                </div>
              </div>

              <table class="table table-bordered table-hover text-center">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>ุงูุงุณู ุงููุงูู</th>
                    <th>ุงููุตู</th>
                    <th>ุงูุดุนุจุฉ</th>
                    <th>ุฑูู ููู ุงูุฃูุฑ</th>
                    <th>ุงูุฌูุณ</th>
                    <th>ุงูุนูููุงุช</th>
                  </tr>
                </thead>

                <tbody>
                  <% if (students.length === 0) { %>
                    <tr>
                      <td colspan="7">ูุง ููุฌุฏ ุทูุงุจ ูุถุงููู</td>
                    </tr>
                  <% } %>

                  <% students.forEach((student, index) => { %>
                    <tr
                      data-name="<%= student.fullName.toLowerCase() %>"
                      data-class="<%= student.classId ? student.classId.name.toLowerCase() : '' %>"
                      data-section="<%= student.sectionId ? student.sectionId.name.toLowerCase() : '' %>"
                    >
                      <td><%= index + 1 %></td>
                      <td><%= student.fullName %></td>
                      <td><%= student.classId ? student.classId.name : 'โ' %></td>
                      <td><%= student.sectionId ? student.sectionId.name : 'โ' %></td>
                      <td><%= student.phoneOfParents || 'โ' %></td>
                                  <td>
  <%= student.gender === 'Male' ? 'ุฐูุฑ' : student.gender === 'Female' ? 'ุฃูุซู' : 'โ' %>
</td>
                      <td>
                        <a href="/school-admin/students/<%= student._id %>" class="btn btn-sm btn-info">
                          ุนุฑุถ
                        </a>
                        <a href="/school-admin/students/<%= student._id %>/edit" class="btn btn-sm btn-warning">
                          ุชุนุฏูู
                        </a>
                      </td>
                    </tr>
                  <% }) %>
                </tbody>
              </table>

            </div>
          </div>
        </div>
      </div>

    </div>
  </main>

</div>

<%- include('../../../partials/scripts.ejs') %>

<!-- ๐ง JavaScript ุงูุจุญุซ -->
<script>
  const searchInput = document.getElementById('studentSearch');
  const rows = document.querySelectorAll('tbody tr');

  searchInput.addEventListener('keyup', () => {
    const value = searchInput.value.toLowerCase().trim();

    rows.forEach(row => {
      const name = row.dataset.name || '';
      const className = row.dataset.class || '';
      const section = row.dataset.section || '';

      const match =
        name.includes(value) ||
        className.includes(value) ||
        section.includes(value);

      row.style.display = match ? '' : 'none';
    });
  });
</script>

</body>
</html>
