<!doctype html>
<html class="no-js" lang="ar">

<%- include('../../../partials/head.ejs') %>

<body class="rtl">

<div class="bmd-layout-container bmd-drawer-f-l avam-container animated bmd-drawer-in">

  <%- include('../../../partials/header.ejs') %>

  <div id="dw-s1" class="bmd-layout-drawer bg-faded">
    <%- include('../../../partials/sidebar/index.ejs') %>
  </div>

  <main class="bmd-layout-content">
    <div class="container-fluid">

      <!-- Breadcrumb / Header -->
      <div class="row m-1 pb-4 mb-3">
        <div class="col-12 p-2">
          <div class="page-header breadcrumb-header">
            <div class="row align-items-end">
              <div class="col-lg-8">
                <h3 class="lite-text">مدراء المدارس</h3>
                <span class="lite-text text-gray">
                  عرض وإدارة جميع مدراء المدارس في النظام
                </span>
              </div>
              <div class="col-lg-4 text-left">
                <!-- زر إضافة مستقبلي إن لزم -->
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Search Box -->
      <div class="row m-1 mb-3">
        <div class="col-lg-4 col-md-6">
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text">
                <i class="fas fa-search"></i>
              </span>
            </div>
            <input
              type="text"
              id="searchInput"
              class="form-control"
              placeholder="ابحث باسم المدير أو المدرسة">
          </div>
        </div>
      </div>

      <!-- Table -->
      <div class="row m-1">
        <div class="col-12 p-2">
          <div class="card shade h-100">
            <div class="card-header">
              قائمة مدراء المدارس
            </div>

            <div class="card-body p-0">
              <div class="table-responsive">
                <table class="table table-bordered table-hover text-center mb-0">
                  <thead class="thead-light">
                    <tr>
                      <th style="width:60px">#</th>
                      <th>اسم المدير</th>
                      <th>البريد الإلكتروني</th>
                      <th>الهاتف</th>
                      <th>المدرسة</th>
                      <th style="width:160px">العمليات</th>
                    </tr>
                  </thead>
                  <tbody id="adminsTableBody">

                    <% if (schoolAdmins.length === 0) { %>
                      <tr>
                        <td colspan="6" class="py-4 text-muted">
                          لا يوجد مدراء مدارس حالياً
                        </td>
                      </tr>
                    <% } %>

                    <% schoolAdmins.forEach((admin, index) => { %>
                      <tr>
                        <td><%= index + 1 %></td>
                        <td class="name font-weight-bold">
                          <%= admin.name %>
                        </td>
                        <td><%= admin.email %></td>
                        <td><%= admin.phone || '—' %></td>
                        <td class="schoolName">
                          <%= admin.schoolId ? admin.schoolId.name : '—' %>
                        </td>
                        <td>
                          <a
                            href="/super-admin/school-admins/<%= admin._id %>/view"
                            class="btn btn-secondary btn-sm">
                            <i class="fas fa-eye"></i>
                            عرض
                          </a>
                          <a
                            href="/super-admin/school-admins/<%= admin._id %>/edit"
                            class="btn btn-warning btn-sm">
                            <i class="fas fa-edit"></i>
                            تعديل
                          </a>
                        </td>
                      </tr>
                    <% }) %>

                  </tbody>
                </table>
              </div>
            </div>

          </div>
        </div>
      </div>

    </div>
  </main>

</div>

<%- include('../../../partials/scripts.ejs') %>

<script>
const searchInput = document.getElementById('searchInput');

searchInput.addEventListener('input', () => {
  const filter = searchInput.value.toLowerCase();
  const rows = document.querySelectorAll('#adminsTableBody tr');

  rows.forEach(row => {
    const name = row.querySelector('.name')?.textContent.toLowerCase() || '';
    const school = row.querySelector('.schoolName')?.textContent.toLowerCase() || '';
    row.style.display =
      name.includes(filter) || school.includes(filter) ? '' : 'none';
  });
});
</script>

</body>
</html>
